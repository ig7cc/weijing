"use strict";function Detailgoods(){this.init()}Detailgoods.prototype={init:function(){this.getDetaildata()},getDetaildata:function(){this.id=location.href.split("?")[1].split("=")[1],axios({method:"get",url:"http://localhost/weijinggit/src/php/detail.php",data:{id:this.id}}).then(this.getDetaildataSuc.bind(this))},getDetaildataSuc:function(t){console.log(t),this.render(t)},render:function(t){this.oDetail=document.getElementById("detail");for(var i="",e=0;e<t.dsmallimg.split(",").length;e++)i+='<li><img src="imgs/'.concat(t.dsmallimg.split(",")[e],'" data-src="imgs/').concat(t.dbigimg.split(",")[e],'" class="minimg" alt=""></li>');str='<ul class="smallPic">\n                    '.concat(i,'\n                </ul>\n                <div class="maxPic">\n                    <div class="filter"></div>\n                    <img src="imgs/').concat(t.dbigimg.split(",")[0],'" class="js_maxPic" alt="">\n                </div>\n                <div class="text_box">\n                    <p class="introduce">').concat(t.dintro,'</p>\n                    <p class="message">').concat(t.dmes,'</p>\n                    <p class="soldprice">').concat(t.dprice,'</p>\n                    <div class="scolor"> <i>选择颜色</i> <span></span></div>\n                    <div class="choosebtn">\n                        <span class="snum">选择数量</span>\n                        <div class="btns">\n                            <button class="reduce">-</button>\n                            <input type="text" name="" id="" value="1">\n                            <button class="add">+</button>\n                        </div>\n                    </div>\n                    <button class="cart">加入购物车</button>\n                    <button class="lookCart">查看购物车</button>\n                </div>\n                <div class="maxImg">\n                    <img src="imgs/').concat(t.dbigimg.split(",")[0],'" class="js_maxImg" alt="">\n                </div>'),this.oDetail.innerHTML=str,this.maxPic=document.querySelector(".maxPic"),this.js_maxImg=document.querySelector(".js_maxImg"),this.filter=document.querySelector(".filter"),this.maxImg=document.querySelector(".maxImg"),this.overmaxPic(),this.outmaxPic(),this.mouseoveroDetail(),this.clickoDetail()},overmaxPic:function(){this.maxPic.addEventListener("mouseover",this.overmaxPicCb.bind(this))},overmaxPicCb:function(){this.filter.style.display="block",this.maxImg.style.display="block",this.moveFilter()},moveFilter:function(){this.filter.addEventListener("mousemove",this.moveFilterCb.bind(this))},moveFilterCb:function(t){var i=(t=t||event).pageX-offset(this.maxPic).l-this.filter.offsetWidth/2,e=t.pageY-offset(this.maxPic).t-this.filter.offsetHeight/2;i=i>=this.maxPic.offsetWidth-this.filter.offsetWidth?this.maxPic.offsetWidth-this.filter.offsetWidth:i<=0?0:i,e=e>=this.maxPic.offsetHeight-this.filter.offsetHeight?this.maxPic.offsetHeight-this.filter.offsetHeight:e<=0?0:e,this.filter.style.left=i+"px",this.filter.style.top=e+"px",this.js_maxImg.style.left=-2*i+"px",this.js_maxImg.style.top=-2*e+"px"},outmaxPic:function(){this.maxPic.addEventListener("mouseout",this.outmaxPicBc.bind(this))},outmaxPicBc:function(){this.filter.style.display="none",this.maxImg.style.display="none"},mouseoveroDetail:function(){this.oDetail.addEventListener("mouseover",this.mouseoveroDetailCb.bind(this))},mouseoveroDetailCb:function(t){var i=(t=t||event).target||t.srcElement;if("IMG"==i.tagName&&"minimg"==i.className){var e=i.getAttribute("data-src");i.parentNode.parentNode.nextElementSibling.children[1].src=e,i.parentNode.parentNode.parentNode.children[3].children[0].src=e}},clickoDetail:function(){this.oDetail.addEventListener("click",this.clickoDetailCb.bind(this))},clickoDetailCb:function(t){var i=(t=t||event).target||t.srcElement;if("BUTTON"==i.tagName&&"add"==i.className&&i.previousElementSibling.value++,"BUTTON"==i.tagName&&"reduce"==i.className){if(1==i.nextElementSibling.value)return;i.nextElementSibling.value--}if("BUTTON"==i.tagName&&"cart"==i.className){var e=i.previousElementSibling.children[1].children[1].value;if(localStorage.getItem("dgoods")){var s=JSON.parse(localStorage.getItem("dgoods"));console.log(s);for(var a=!0,o=0;o<s.length;o++)if(s[o].id==this.id){s[o].num=e,a=!1,localStorage.setItem("dgoods",JSON.stringify(s));break}a&&(s.push({id:this.id,num:e}),localStorage.setItem("dgoods",JSON.stringify(s)))}else localStorage.setItem("dgoods",JSON.stringify([{id:this.id,num:e}]))}"BUTTON"==i.tagName&&"lookCart"==i.className&&(location.href="shoppingCart.html")}},new Detailgoods;