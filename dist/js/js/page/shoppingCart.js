"use strict";function Shoppingcart(){this.init()}Shoppingcart.prototype={init:function(){this.getCartData()},getCartData:function(){axios({method:"get",url:"http://localhost/weijinggit/src/php/shoppingCart.php"}).then(this.getCartDataSuccess.bind(this))},getCartDataSuccess:function(e){console.log(e),this.render(e)},render:function(e){if(localStorage.dgoods){this.obj=JSON.parse(localStorage.dgoods);var t="",n=document.getElementsByClassName("box")[0];console.log(this.obj);for(var i=0;i<this.obj.length;i++)for(var o=0;o<e.length;o++)this.obj[i].id==e[o].did&&(t+='<ul class="television" data-id="'.concat(this.obj[i].id,'">\n                    <li>\n                        <label for="">\n                            <input type="checkbox" class="single" value="" />\n                        </label>\n                        <img src="imgs/').concat(e[o].dsmallimg.split(",")[0],'" />\n                    </li>\n                    <li>').concat(e[o].dintro," </li>\n                    <li>").concat(e[o].dprice,'</li>\n                    <li>\n                        <button class="reduce">-</button>\n                        <input type="text" name="" id="" value="').concat(this.obj[i].num,'" />\n                        <button class="add">+</button>\n                    </li>\n                    <li>￥').concat((this.obj[i].num*e[o].dprice.slice(1)).toFixed(2),'</li>\n                    <li>\n                        <a href="##" class="del">删除</a>\n                    </li>\n                </ul>'));n.innerHTML=t}this.clickShoppingcart()},clickShoppingcart:function(){document.querySelector(".shoppingCar").addEventListener("click",this.clickShoppingcartCb.bind(this))},clickShoppingcartCb:function(e){var t=(e=e||event).target||e.srcElement;if("BUTTON"==t.tagName&&"reduce"==t.className){if(1==t.nextElementSibling.value)return;t.nextElementSibling.value--;for(var n=t.parentNode.parentNode.getAttribute("data-id"),i=0;i<this.obj.length;i++)this.obj[i].id==n&&(this.obj[i].num=t.nextElementSibling.value,console.log(this.obj),localStorage.setItem("dgoods",JSON.stringify(this.obj)));var o=t.nextElementSibling.value*t.parentNode.previousElementSibling.innerText.substr(1);t.parentNode.nextElementSibling.innerText="￥"+o.toFixed(2)}if("BUTTON"==t.tagName&&"add"==t.className){t.previousElementSibling.value++;for(n=t.parentNode.parentNode.getAttribute("data-id"),i=0;i<this.obj.length;i++)this.obj[i].id==n&&(this.obj[i].num=t.previousElementSibling.value,console.log(this.obj),localStorage.setItem("dgoods",JSON.stringify(this.obj)));var l=t.previousElementSibling.value*t.parentNode.previousElementSibling.innerText.substr(1);t.parentNode.nextElementSibling.innerText="￥"+l.toFixed(2)}if("A"==t.tagName&&"del"==t.className){n=t.parentNode.parentNode.getAttribute("data-id");t.parentNode.parentNode.remove();for(i=0;i<this.obj.length;i++)this.obj[i].id==n&&(this.obj.splice(i,1),console.log(this.obj),localStorage.setItem("dgoods",JSON.stringify(this.obj)))}var a=document.querySelectorAll(".all"),r=document.querySelectorAll(".single");if("all"==t.className){for(i=0;i<r.length;i++)r[i].checked=t.checked;for(var s=0;s<a.length;s++)a[s].checked=t.checked}if("single"==t.className){var c=!0;for(i=0;i<r.length;i++)if(!r[i].checked){c=!1;break}for(s=0;s<a.length;s++)a[s].checked=c}var d=0;for(i=0;i<r.length;i++)r[i].checked&&(d+=Number(r[i].parentNode.parentNode.parentNode.children[4].innerText.substr(1)));document.querySelector(".total").children[1].innerText="总价:￥"+d.toFixed(2)}},new Shoppingcart;